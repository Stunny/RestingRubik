doctype html
html(lang='es')
  head
    script(src='//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js')
    script(src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/highlight.min.js')
    script.
      hljs.initHighlightingOnLoad();
    meta(charset='utf-8')   
    title RestingRubik - Cube Form  
  body
    a(href=serveraddress) Index    
    h1 Cube Form   
    form(id='addcube', enctype='application/json', method='post', action=serveraddress+'api/cube')
      input(type='text', name='nombre', placeholder='Nombre')
      input(type='text', name='brand', placeholder='Marca')
      input(type='text', name='capas', placeholder='Capas')
      select(name='kind')
        option(selected) Regular             
        option Cuboid             
        option Modification    
      input(type='submit', value='POST')
    br
    pre
      code(id='result_body', class='json')
    script.
        $('#addcube').submit(function(event){
          
          //Evito que el boton de submit mueva a otra pagina.
          event.preventDefault(); 
          
          //Recojo los valores introducidos en el formulario
          var $form = $(this),
              nom = $form.find('input[name="nombre"]').val(),
              marca = $form.find('input[name="brand"]').val(),
              layers = $form.find('input[name="capas"]').val(),
              tipo = $form.find('input[name="kind"]').val(),
              
              url = $form.attr('action');
          
          //Envio los valores a la api
          var send = $.post(url, {
            nombre : nom,
            brand  : marca,
            capas  : layers,
            kind   : tipo
          }, "application/json"); //Set the expected reponse type to JSON
          
          send.done(function(cube, textStatus){
            console.log(cube);
            console.log(textStatus);
            $('#result_body').text(JSON.stringify(cube, null, "\t"));
          });
          
          // handle errors
          send.fail(function(jqxhr, textStatus, errorThrown) {
            console.log(textStatus, errorThrown, errorThrown.msg)
          });
          
          $('code').each(function(i, block){
            hljs.highlightBlock(block);
          });
        });
        
