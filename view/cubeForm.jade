doctype html
html(lang='es')
  head
    link(rel='stylesheet', href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/default.min.css')
    script(src='//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js')
    script(src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/highlight.min.js')
    meta(charset='utf-8')   
    title RestingRubik - Cube Form  
  body
    a(href=serveraddress) Index    
    h1 Cube Form   
    form(id='addcube', enctype='application/json', method='post', action=serveraddress+'api/cube')
      input(type='text', name='nombre', placeholder='Nombre')
      input(type='text', name='brand', placeholder='Marca')
      input(type='text', name='capas', placeholder='Capas')
      select(name='kind')
        option(selected, value='Regular') Regular
        option(value='Cuboid') Cuboid
        option(value='Modification') Modification
      input(type='submit', value='POST')
    br
    pre
      code(id='result_body')
    script.
        $('#addcube').submit(function(event){
          
          //Evito que el boton de submit mueva a otra pagina.
          event.preventDefault(); 
          
          //Recojo los valores introducidos en el formulario
          var $form = $(this),
              nom = $form.find('input[name="nombre"]').val(),
              marca = $form.find('input[name="brand"]').val(),
              layers = $form.find('input[name="capas"]').val(),
              tipo = $form.find('select[name="kind"]').val(),
              
              url = $form.attr('action');
          
          //Envio los valores a la api
          var send = $.post(url, {
            nombre : nom,
            brand  : marca,
            capas  : layers,
            kind   : tipo
          }, "application/json"); //Set the expected reponse type to JSON
          
          send.done(function(cube, textStatus){
            if($('#result_body').hasClass()) $('#result_body').removeAttr('class');
            console.log(cube);
            console.log(textStatus);
            $('#result_body').addClass('json');
            $('#result_body').text(JSON.stringify(cube, null, "\t"));
            hljs.highlightBlock($('#result_body').get(0));
          });
          
          // handle errors
          send.fail(function(jqxhr, textStatus, errorThrown) {
            console.log(textStatus, errorThrown, errorThrown.msg)
          });
          
        });
        
